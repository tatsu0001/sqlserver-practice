SQLServer2012ExpressEditionでCSV形式のファイルへの
リンクサーバを追加する設定。

0. SQLServerExpressEdtionのインストール
   -> SQLサーバのインスタンス起動ユーザはCSVファイルを置くディレクトリのユーザアカウントを使用すること
      (SQLサーバがディレクトリの所有者と違うユーザで起動している場合、
       ファイル/ディレクトリへのアクセス権限が問題でOLEDBプロバイダが動作しないことがある)
      Windows権限設定を熟知している人ならその限りではない

1. SQLServerManagementStdioを起動する。
   Windows認証で管理者権限でログインする。

2. [サーバオブジェクト]->[リンクサーバー]->右クリック
   -> [新しいリンクサーバー....] 
   -> 以下の入力
     - リンクサーバー:適当
     - その他のデータソース:チェック
     - プロバイダー:Microsoft.Jet.OLEDB.4.0
     - 製品名:任意
     - データソース:CSVファイルが格納されたディレクトリ(※)のフルパス
     - プロバイダー文字列:Text
   -> [OK]
   ※ファイルではないので注意 

3. [リンクサーバー]配下の2で追加したリンクサーバーの
   [カタログ] -> [default] -> [テーブル] -> [システムテーブル]
   でファイル名が表示されるか確認。

4. 上記3でエラーになる場合、以下を実施
   [サーバーオブジェクト] -> [リンクサーバー] -> [プロバイダー]
   -> [Microsoft.Jet.OLEDB.4.0] -> 右クリック -> [プロパティ]
   -> 以下の設定
        動的パラメータ:有効化
        InProcess許可:有効化
   -> [OK]

5. 手順3を再度実行
   表示されたファイル名を右クリック -> [テーブルをスクリプト化] -> [SELECT] 
     -> [新しいクエリファイル...] -> 実行
   SELECT結果が表示されること。


X. リンクサーバー名を右クリック -> [リンクサーバーをスクリプト化]
   でリンクサーバー作成SQLを外部ファイル化可能


Y. CSVやテキストファイルの構成をプロバイダ側に伝えたい場合
   Schema.iniファイルをCSVファイルと同じディレクトリに配置する。
   Schema.iniのフォーマットはAccess開発者ヘルプの以下のセクションが詳しい。
   [テキスト データ ソース ドライバーを初期化する]

