SQLServer2012ExpressEditionでxlsx(Excel2007)形式のファイルへの
リンクサーバを追加する設定。

0. SQLServerExpressEdtionのインストール
   -> SQLサーバのインスタンス起動ユーザはXlsxファイルを置くディレクトリのユーザアカウントを使用すること
      (SQLサーバがディレクトリの所有者と違うユーザで起動している場合、
       ファイル/ディレクトリへのアクセス権限が問題でOLEDBプロバイダが動作しないことがある)
      Windows権限設定を熟知している人ならその限りではない

1. SQLServerManagementStdioを起動する。
   Windows認証で管理者権限でログインする。

2. [サーバオブジェクト]->[リンクサーバー]->右クリック
   -> [新しいリンクサーバー....] 
   -> 以下の入力
     - リンクサーバー:適当
     - その他のデータソース:チェック
     - プロバイダー:Microsoft Office 12.0 Access Database Engine OLE DB
     - 製品名:任意
     - データソース:xlsxファイルのフルパス 
     - プロバイダー文字列:Excel 12.0; HDR=YES; IMEX=1;
   -> [OK]

3. [リンクサーバー]配下の2で追加したリンクサーバーの
   [カタログ] -> [default] -> [テーブル] -> [システムテーブル]
   でシート名が表示されるか確認。

4. 上記3でエラーになる場合、以下を実施
   [サーバーオブジェクト] -> [リンクサーバー] -> [プロバイダー]
   -> [Microsoft.ACE.OLEDB.12.0] -> 右クリック -> [プロパティ]
   -> 以下の設定
        動的パラメータ:有効化
        InProcess許可:有効化
   -> [OK]

5. 手順3を再度実行
   表示されたシート名を右クリック -> [テーブルをスクリプト化] -> [SELECT] 
     -> [新しいクエリファイル...] -> 実行
   SELECT結果が表示されること。

X. リンクサーバー名を右クリック -> [リンクサーバーをスクリプト化]
   でリンクサーバー作成SQLを外部ファイル化可能

Y. プロバイダ文字列についての参照サイト
   http://yoursandmyideas.wordpress.com/2011/02/05/how-to-read-or-write-excel-file-using-ace-oledb-data-provider/
